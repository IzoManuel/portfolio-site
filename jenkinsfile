pipeline {
  agent any

  stages {
    stage('Clone Repository') {
      steps {
        git url: 'https://github.com/IzoManuel/portfolio-site.git', credentialsId: '21701bdd-7c41-4204-9974-db5e390c2cf9'
      }
    }

    stage('Echo Stage') {
      steps {
        echo 'Building the portfolio site...'
      }
    }

    stage('Deploy') {
      steps {
        sshagent(['deploy-ssh-key']) {
          sh """
            scp -o StrictHostKeyChecking=no -r * ubuntu@13.235.51.44:/home/ubuntu/portfolio-site
            ssh -o StrictHostKeyChecking=no ubuntu@13.235.51.44 'bash /home/ubuntu/portfolio-site/deploy.sh'
          """
        }
      }
    }
  }
}
